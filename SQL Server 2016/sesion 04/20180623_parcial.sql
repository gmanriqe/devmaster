--20180623
--EXAMEN PARCIAL 

--1.- INSERCION DE SEDE -- 12 SEDES
INSERT INTO [dbo].[TB_SEDE](NOMBRE_SEDE)
SELECT 'Moscú' UNION ALL
SELECT 'Ekaterimburgo' UNION ALL
SELECT 'Petersburgo' UNION ALL
SELECT 'Rostov del Don' UNION ALL
SELECT 'Samara' UNION ALL
SELECT 'Volgogrado' UNION ALL
SELECT 'Sochi' UNION ALL
SELECT 'San Petersburgo' UNION ALL
SELECT 'Kazán' UNION ALL
SELECT 'Saransk' UNION ALL
SELECT 'Kaliningrado' UNION ALL
SELECT 'Nizhni Nóvgorod'

--2.- INSERCION DE GRUPO -- 10 GRUPOS
INSERT INTO [dbo].[TB_NOMBRE_GRUPO](NOMBRE_GRUPO)
SELECT 'GRUPO A' UNION ALL
SELECT 'GRUPO B' UNION ALL
SELECT 'GRUPO C' UNION ALL
SELECT 'GRUPO D' UNION ALL
SELECT 'GRUPO E' UNION ALL
SELECT 'GRUPO F' UNION ALL
SELECT 'GRUPO G' UNION ALL
SELECT 'GRUPO H' UNION ALL
SELECT 'GRUPO I' UNION ALL
SELECT 'GRUPO J' 

--3.- INSERT ETIQUIPO -- 34 EQUIPOS
INSERT INTO [dbo].[TB_EQUIPO](NOMBRE_EQUIPO,ESTADO)
SELECT 'Arabia Saudita','A' UNION ALL
SELECT 'Rusia','A' UNION ALL
SELECT 'Egipto','A' UNION ALL
SELECT 'Uruguay','A' UNION ALL
SELECT 'Portugal','A' UNION ALL
SELECT 'Marruecos','A' UNION ALL
SELECT 'España','A' UNION ALL
SELECT 'Irán','A' UNION ALL
SELECT 'Francia','A' UNION ALL
SELECT 'Perú','A' UNION ALL
SELECT 'Australia','A' UNION ALL
SELECT 'Dinamarca','A' UNION ALL
SELECT 'Argentina','A' UNION ALL
SELECT 'Croacia','A' UNION ALL
SELECT 'Islandia','A' UNION ALL
SELECT 'Nigeria','A' UNION ALL
SELECT 'Brasil','A' UNION ALL
SELECT 'Costa Rica','A' UNION ALL
SELECT 'Suiza','A' UNION ALL
SELECT 'Serbia','A' UNION ALL
SELECT 'Alemania','A' UNION ALL
SELECT 'Suecia','A' UNION ALL
SELECT 'México','A' UNION ALL
SELECT 'Corea del Sur','A' UNION ALL
SELECT 'Bélgica','A' UNION ALL
SELECT 'Túnez','A' UNION ALL
SELECT 'Panamá','A' UNION ALL
SELECT 'Inglaterra','A' UNION ALL
SELECT 'Polonia','A' UNION ALL
SELECT 'Colombia','A' UNION ALL
SELECT 'Senegal','A' UNION ALL
SELECT 'Japón','A' UNION ALL
SELECT 'Chile','A' UNION ALL
SELECT 'USA','A'

--4.- INSERCION AGRUPA_EQUIPO -- 32 REGISTROS
INSERT INTO [dbo].[TB_AGRUPADO_EQUIPO](IDGRUPO,IDEQUIPO)
SELECT 1,1 UNION ALL
SELECT 1,2 UNION ALL
SELECT 1,3 UNION ALL
SELECT 1,4 UNION ALL
SELECT 2,5 UNION ALL
SELECT 2,6 UNION ALL
SELECT 2,7 UNION ALL
SELECT 2,8 UNION ALL
SELECT 3,9 UNION ALL
SELECT 3,10 UNION ALL
SELECT 3,11 UNION ALL
SELECT 3,12 UNION ALL
SELECT 4,13 UNION ALL
SELECT 4,14 UNION ALL
SELECT 4,15 UNION ALL
SELECT 4,16 UNION ALL
SELECT 5,17 UNION ALL
SELECT 5,18 UNION ALL
SELECT 5,19 UNION ALL
SELECT 5,20 UNION ALL
SELECT 6,21 UNION ALL
SELECT 6,22 UNION ALL
SELECT 6,23 UNION ALL
SELECT 6,24 UNION ALL
SELECT 7,25 UNION ALL
SELECT 7,26 UNION ALL
SELECT 7,27 UNION ALL
SELECT 7,28 UNION ALL
SELECT 8,29 UNION ALL
SELECT 8,30 UNION ALL
SELECT 8,31 UNION ALL
SELECT 8,32 

--5.- Elabore un reporte donde se liste el NOMBRE_DEL_EQUIPO y el GRUPO
--MUNDIAL al que pertenece. Utilice una sola consulta (4 puntos).
SELECT equipo.NOMBRE_EQUIPO, grupo.NOMBRE_GRUPO FROM [dbo].[TB_AGRUPADO_EQUIPO] agrupa
INNER JOIN [dbo].[TB_EQUIPO] equipo on equipo.IDEQUIPO = agrupa.IDEQUIPO
INNER JOIN [TB_NOMBRE_GRUPO] grupo on grupo.IDGRUPO = agrupa.IDGRUPO

--6.- Utilizando una sola consulta actualice al estado inactivo (I) aquellos equipos
--que inicien con la letra “C” o finalicen con la letra “L”. Luego de esta
--modificación, elabore un reporte con los equipos que tengan el estado
--distinto a Activo (A) y muéstrelos en orden alfabético (A-Z). (4 puntos).
UPDATE [dbo].[TB_EQUIPO] -- 8 registros afectados
SET ESTADO = 'I'
WHERE NOMBRE_EQUIPO like 'C%' or NOMBRE_EQUIPO like '%L'

SELECT  * 
FROM [dbo].[TB_EQUIPO] 
WHERE ESTADO != 'A' -- 8 registros
ORDER BY  NOMBRE_EQUIPO ASC

--7.- Registre los encuentros de los equipos de futbol según el Excel adjunto. Use
--la función CONVERT, con tipo de dato DATETIME con el código 103 para
--registrar fechas y horas. Utilice el Excel “Lista de Encuentros”. (3puntos).
--="SELECT CONVERT(DATETIME,'"&B2&"',103),"&D2&","&F2&","&I2&" UNION ALL"
INSERT INTO [dbo].[TB_FIXTURE](FECHA,IDSEDE,IDEQUIPOA,IDEQUIPOB)-- 48 registros insertados
SELECT CONVERT(DATETIME,'14/06/2018 18:00',103),1,2,1 UNION ALL
SELECT CONVERT(DATETIME,'15/06/2018 17:00',103),2,3,4 UNION ALL
SELECT CONVERT(DATETIME,'19/06/2018 21:00',103),3,2,3 UNION ALL
SELECT CONVERT(DATETIME,'20/06/2018 18:00',103),4,4,1 UNION ALL
SELECT CONVERT(DATETIME,'25/06/2018 18:00',103),5,4,2 UNION ALL
SELECT CONVERT(DATETIME,'25/06/2018 17:00',103),6,1,3 UNION ALL
SELECT CONVERT(DATETIME,'15/06/2018 21:00',103),7,5,7 UNION ALL
SELECT CONVERT(DATETIME,'15/06/2018 18:00',103),8,6,8 UNION ALL
SELECT CONVERT(DATETIME,'20/06/2018 15:00',103),9,5,6 UNION ALL
SELECT CONVERT(DATETIME,'20/06/2018 21:00',103),10,8,7 UNION ALL
SELECT CONVERT(DATETIME,'25/06/2018 21:00',103),11,8,5 UNION ALL
SELECT CONVERT(DATETIME,'25/06/2018 20:00',103),12,7,6 UNION ALL
SELECT CONVERT(DATETIME,'16/06/2018 13:00',103),10,9,11 UNION ALL
SELECT CONVERT(DATETIME,'16/06/2018 19:00',103),11,10,12 UNION ALL
SELECT CONVERT(DATETIME,'21/06/2018 17:00',103),2,9,10 UNION ALL
SELECT CONVERT(DATETIME,'21/06/2018 19:00',103),5,12,11 UNION ALL
SELECT CONVERT(DATETIME,'26/06/2018 17:00',103),9,12,9 UNION ALL
SELECT CONVERT(DATETIME,'26/06/2018 17:00',103),7,11,10 UNION ALL
SELECT CONVERT(DATETIME,'16/06/2018 21:00',103),9,13,15 UNION ALL
SELECT CONVERT(DATETIME,'16/06/2018 21:00',103),12,14,16 UNION ALL
SELECT CONVERT(DATETIME,'21/06/2018 21:00',103),12,13,14 UNION ALL
SELECT CONVERT(DATETIME,'22/06/2018 18:00',103),6,16,15 UNION ALL
SELECT CONVERT(DATETIME,'26/06/2018 21:00',103),8,16,13 UNION ALL
SELECT CONVERT(DATETIME,'26/06/2018 21:00',103),4,15,14 UNION ALL
SELECT CONVERT(DATETIME,'17/06/2018 21:00',103),4,17,19 UNION ALL
SELECT CONVERT(DATETIME,'17/06/2018 16:00',103),5,18,20 UNION ALL
SELECT CONVERT(DATETIME,'22/06/2018 15:00',103),8,17,18 UNION ALL
SELECT CONVERT(DATETIME,'22/06/2018 20:00',103),12,20,19 UNION ALL
SELECT CONVERT(DATETIME,'27/06/2018 21:00',103),9,20,17 UNION ALL
SELECT CONVERT(DATETIME,'27/06/2018 21:00',103),12,19,18 UNION ALL
SELECT CONVERT(DATETIME,'17/06/2018 18:00',103),9,21,23 UNION ALL
SELECT CONVERT(DATETIME,'18/06/2018 15:00',103),12,22,24 UNION ALL
SELECT CONVERT(DATETIME,'23/06/2018 18:00',103),7,21,22 UNION ALL
SELECT CONVERT(DATETIME,'23/06/2018 21:00',103),4,24,23 UNION ALL
SELECT CONVERT(DATETIME,'27/06/2018 17:00',103),9,24,21 UNION ALL
SELECT CONVERT(DATETIME,'27/06/2018 19:00',103),2,23,22 UNION ALL
SELECT CONVERT(DATETIME,'18/06/2018 18:00',103),7,25,27 UNION ALL
SELECT CONVERT(DATETIME,'18/06/2018 21:00',103),6,26,28 UNION ALL
SELECT CONVERT(DATETIME,'23/06/2018 15:00',103),1,25,26 UNION ALL
SELECT CONVERT(DATETIME,'24/06/2018 15:00',103),12,28,27 UNION ALL
SELECT CONVERT(DATETIME,'28/06/2018 20:00',103),11,28,25 UNION ALL
SELECT CONVERT(DATETIME,'28/06/2018 21:00',103),10,27,26 UNION ALL
SELECT CONVERT(DATETIME,'19/06/2018 15:00',103),1,29,31 UNION ALL
SELECT CONVERT(DATETIME,'19/06/2018 18:00',103),10,30,32 UNION ALL
SELECT CONVERT(DATETIME,'24/06/2018 21:00',103),9,29,30 UNION ALL
SELECT CONVERT(DATETIME,'24/06/2018 20:00',103),2,32,31 UNION ALL
SELECT CONVERT(DATETIME,'28/06/2018 3:00',103),6,32,29 UNION ALL
SELECT CONVERT(DATETIME,'28/06/2018 18:00',103),5,31,30

--8.- Elabore un reporte donde se muestre la fecha de juego, sede, nombre de los
--equipos A y B con su respectivo resultado que sean de la siguiente fecha “15-
--06-2018” o “21-06-2018”. Use la función CONVERT, con tipo de dato
--DATE con el código 103 para filtrar fechas (5puntos).

SELECT CONVERT(DATE,fix.FECHA,103)as fecha, sede.NOMBRE_SEDE, equiA.NOMBRE_EQUIPO, equiB.NOMBRE_EQUIPO  
FROM [dbo].[TB_FIXTURE] fix
INNER JOIN [dbo].[TB_SEDE] sede on sede.IDSEDE = fix.IDSEDE
INNER JOIN [dbo].[TB_EQUIPO] equiA on equiA.IDEQUIPO = fix.IDEQUIPOA
INNER JOIN [dbo].[TB_EQUIPO] equiB on equiB.IDEQUIPO = fix.IDEQUIPOB
WHERE CONVERT(DATE,fix.FECHA,103) in (CONVERT(DATE,'15-06-2018',103),CONVERT(DATE,'21-06-2018',103))

--9.- Teniendo la siguiente query, añadir un filtro para que se muestre los registros
--entre diferentes fechas y entre estas mismas no sean menor de 4 días
--(3puntos)
SELECT f.FECHA, s.NOMBRE_SEDE, eA.NOMBRE_EQUIPO, f.SCOREA,
eB.NOMBRE_EQUIPO, f.SCOREB
FROM TB_FIXTURE f 
INNER JOIN TB_SEDE s ON f.IDSEDE = s.IDSEDE 
INNER JOIN TB_EQUIPO eA ON f.IDEQUIPOA = eA.IDEQUIPO 
INNER JOIN TB_EQUIPO eB ON f.IDEQUIPOB = eB.IDEQUIPO
WHERE CONVERT(DATE,f.FECHA,103) between CONVERT(DATE,'15-06-2018',103) and CONVERT(DATE,'19-06-2018',103)